package com.brentcodes.springboot.librarysystem.vulnerability;

import org.springframework.data.jpa.repository.JpaRepository;

import java.time.Instant;
import java.util.List;
import java.util.Optional;

public interface VulnerabilityRepository extends JpaRepository<Vulnerability, Long> {
    //Spring Data JPA, you can write custom SQL-like behavior by just defining method names in your repository
    // interface — as long as you follow Spring’s naming conventions.
    Optional<Vulnerability> findVulnerabilityByProjectIdAndId(Long projectId, Long vulnerabilityId);

    List<Vulnerability> findVulnerabilitiesByProjectId(Long projectId);

    Optional<Vulnerability> findVulnerabilityByProjectIdAndTitle(Long projectId, String title);

    List<Vulnerability> findByDueAtBeforeAndStatusNotAndProjectId(Instant dueAtBefore, VulnStatus status, Long projectId);

    List<Vulnerability> findVulnerabilitiesByProjectIdAndSeverity(Long projectId, Severity severity);

    // Admin Functions ---------------------------------
    Optional<Vulnerability> findVulnerabilityById(Long vulnerabilityId);

    Optional<Vulnerability> findVulnerabilityByTitle(String title);

    List<Vulnerability> findVulnerabilitiesBySeverity(Severity severity);

    List<Vulnerability> findByDueAtBeforeAndStatusNot(Instant now, VulnStatus vulnStatus);

    Vulnerability getVulnerabilitiesById(Long id);
}
